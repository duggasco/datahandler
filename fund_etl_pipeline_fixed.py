# Key changes in this fix:
# 1. Modified load_to_database() to accept an optional connection parameter
# 2. Fixed update_from_lookback() to use a single database connection
# 3. Improved date handling to avoid duplicate weekend entries
# 4. Better transaction management to prevent locking issues

# The fixed version is already in the artifact above
# This is just a placeholder to show the key changes
